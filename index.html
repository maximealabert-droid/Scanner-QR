<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scanner QR3</title>

<script src="https://unpkg.com/@zxing/library@latest"></script>

<style>
body {
  font-family: Arial, sans-serif;
  text-align: center;
  padding: 20px;
  background: #f4f6f8;
}

video {
  width: 100%;
  max-width: 350px;
  border-radius: 12px;
}

button {
  padding: 14px 20px;
  margin: 10px;
  font-size: 16px;
  border-radius: 8px;
  border: none;
  background: #0078D4;
  color: white;
  cursor: pointer;
}
</style>
</head>

<body>

<h2>üì∑ Scanner QR3</h2>

<video id="video" muted playsinline></video>
<br>
<button onclick="startScanner()">D√©marrer Scan</button>
<button onclick="stopScanner()">Stop</button>

<script>
let codeReader;
let videoElement = document.getElementById('video');

async function startScanner() {
  codeReader = new ZXing.BrowserQRCodeReader();

  try {
    const devices = await ZXing.BrowserQRCodeReader.listVideoInputDevices();
    const deviceId =
      devices.find(d => d.label.toLowerCase().includes("back"))?.deviceId
      || devices[0].deviceId;

    codeReader.decodeFromVideoDevice(deviceId, videoElement, (result, err) => {
      if (result) {
        alert("QR d√©tect√© : " + result.text);
        stopScanner();
      }
    });
  } catch (err) {
    alert("Erreur cam√©ra : " + err);
  }
}

function stopScanner() {
  if (codeReader) {
    codeReader.reset();
  }
}
</script>

</body>
</html>
